(function(t){function e(t,e,n){var r=document.createElement(t);if(e)for(var i in e)r.setAttribute(i,e[i]);return n&&(r.innerHTML=n),r}function n(t,e,r){if(this.el=t||document.body,this.parent=e||null,this.signals=r||{},this.parent&&this.parent.el.appendChild(this.el),t.childNodes)for(var i=0;t.childNodes.length>i;i++){var o=new n(t.childNodes[i],null);o.setParent(this)}}function r(t,r,i,o){var s=new n(e(t,r,i),o);return o||document.body.appendChild(s.el),s}if(!document)throw Error("No HTML document found");n.prototype.setParent=function(t){return this.parent=t,this},n.prototype.isPony=function(){return!0},n.prototype.find=function(t){return this.el.querySelector(t)},n.prototype.findAll=function(t){return this.el.querySelectorAll(t)},n.prototype.appendNew=function(t,e,n){var i=r(t,e,n,this);return i},n.prototype._append=function(t){if(t.parent)throw Error("Cannot append child which already has a parent");if(!t.isPony||!t.isPony())throw Error("Cannot append child not derived from Pony");return t.setParent(this),this.el.appendChild(t.el),this},n.prototype.append=function(t){if(Array.isArray(t)){for(var e=0;t.length>e;e++)this._append(t[e]);return this}return this._append(t)},n.prototype.attribute=function(t,e){return void 0===e?this.el.getAttribute(t):e?this.el.setAttribute(t,e):this.el.removeAttribute(t)},n.prototype.text=function(t){return t?(this.el.innerHTML=t,void 0):this.el.innerHTML},n.prototype.remove=function(){this.el.remove()},n.prototype.clear=function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)},n.prototype.disable=function(t){this.el.disabled=t},n.prototype.getElementClasses=function(){var t=this.el.getAttribute("class");return t?t.split(" "):[]},n.prototype.setClass=function(t){var e=this.getElementClasses();return-1===e.indexOf(t)?(e.push(t),this.el.setAttribute("class",e.join(" "))):void 0},n.prototype.removeClass=function(t){var e=this.getElementClasses(this.el),n=e.indexOf(t);return-1!==n?(e.splice(n,1),this.el.setAttribute("class",e.join(" "))):void 0},n.prototype.value=function(t){return void 0!==t?this.el.value=t:this.el.value},t.Pony={create:e,el:r,Pony:n,wrap:function(t,e){return new n(t,e)}}})(this);(function(e){function t(t,a){var r=new e.Pony.el("th",{});return t.head?r.append(t.head(a)):r.appendNew("span",{},t.title),r}function a(a,r,n){this.head=r,this.base=new e.Pony.el("table",a,null,n),this.thead=this.base.appendNew("thead"),this.tbody=this.base.appendNew("tbody"),this.data=[];var o=this.thead.appendNew("tr");for(var i in r){var l=t(r[i],this);o.append(l)}}function r(t,a,r){var n=new e.Pony.el(t,a);this.base=n,this.delegate=r||function(e){return n.appendNew("li",{},e)}}function n(e,t){switch(e.tagName.toLowerCase()){case"input":var a=e.getAttribute("type");if("checkbox"===a)return Boolean(t)?e.setAttribute("checked","checked"):e.removeAttribute("checked");break;case"textarea":e.innerHTML=t;break;default:}return e.value=t}if(!e.Pony)throw Error("Pony.js Core missing or not loaded");r.prototype.display=function(e,t){for(var a=0;e.length>a;a++)this.base.append(this.delegate(e[a],t))},a.prototype.display=function(e,t){if(!Array.isArray(e))throw Error("Table data must be an array");this.tbody.clear();for(var a=0;e.length>a;a++){var r=this.tbody.appendNew("tr");for(var n in this.head){var o=r.appendNew("td");this.head[n].delegate?o.append(this.head[n].delegate(e[a],t)):o.el.appendChild(document.createTextNode(e[a][n]))}}},Pony.Pony.prototype.serialize=function(){for(var e=Array.prototype.slice.call(this.el.querySelectorAll("input,select,textarea,select")),t={},a=0;e.length>a;a++){var r=e[a].getAttribute("name"),n=e[a].value;n&&("checkbox"===e[a].getAttribute("type")&&(n=!!e[a].checked),"number"===e[a].getAttribute("type")&&(n=parseFloat(e[a].value)),t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(n)):t[r]=n)}return t},Pony.Pony.prototype.getInputElements=function(){return Array.prototype.slice.call(this.el.querySelectorAll("input,select,textarea"))},Pony.Pony.prototype.fill=function(e){for(var t=this.getInputElements(),a=0;t.length>a;a++){var r=t[a].getAttribute("name");e[r]&&n(t[a],e[r])}},Pony.Pony.prototype.disableAll=function(e){for(var t=this.getInputElements(),a=0;t.length>a;a++)e?t[a].setAttribute("disabled","disabled"):t[a].removeAttribute("disabled")},e.Pony.Shedrow={Table:a,List:r}})(this);(function(e){function t(e,t){if(n[e])return t?t(n[e]):n[e];var r=document.createElement("script");return r.src=e,t&&(r.onload=r.onerror=r.onreadystatechange=t),(document.head||document.getElementsByTagName("head")[0]).appendChild(r)}for(var n={},r=document.querySelectorAll("script[src]"),c=0;r.length>c;c++)n[r[c].getAttribute("src")]=r[c];e.Pony?e.Pony.include=t:e.include=t})(this);(function(n){function t(n,t){this.connections=[],t&&(n.el[t]=this.emit.bind(this))}t.prototype.connect=function(n){-1===this.connections.indexOf(n)&&this.connections.push(n)},t.prototype.disconnect=function(n){var t=this.connections.indexOf(n);if(-1===t)throw Error("Cannot disconnect unconnected signal handler");return this.connections.splice(t,1)},t.prototype.disconnectAll=function(){this.connections=[]},t.prototype.emit=function(){for(var n=0;this.connections.length>n;n++){var t=this.connections[n].apply(this,arguments);t===!1&&this.connections.splice(n,1)}return!1},n.Pony.Pony.prototype.signal=function(n){return new t(this,n)},n.Pony?n.Pony.Signal=t:n.Signal=t})(this);(function(n){function i(n,i){return function(){for(var t in i)this[t]=i[t].bind(n);return this}}function t(n,t){return i(n,t).call(n.prototype)}n.Pony?n.Pony.mixin=t:n.mixin=t})(this);(function(t){function r(t,r){this.requestData={jsonrpc:"2.0",id:"_rpc_"+(""+e++),method:t,params:r},this.xhr=new XMLHttpRequest,this.onResponse=function(){throw Error("RPC Request sent without response callback")},this.onError=function(t){console.error(t.message||t.error||t)},this.xhr.open("POST","/"),this.xhr.setRequestHeader("Content-type","application/json"),this.xhr.onreadystatechange=function(){try{if(4===this.xhr.readyState){var t=JSON.parse(this.xhr.responseText);if(t.error)return this.onError(t.error);this.onResponse(t.result)}}catch(r){this.onError(r)}}.bind(this)}var e=0;r.prototype.timeout=function(t){return this.xhr.timeout=t,this},r.prototype.response=function(t){return this.onResponse=t,this},r.prototype.error=function(t){return this.onError=t,this},r.prototype.send=function(){return this.xhr.send(JSON.stringify(this.requestData)),this},t.Pony?t.Pony.Rpc=r:t.Rpc=r})(this);(function(t){function e(t,e,n){"object"==typeof t&&(this.template=t),this.templatePath=t,this.onError=function(t){console.error(t)},this.delegates={},this.delegateHandlers={},this.signals={},this.pony=null,this.parent=e,this.context=n||{}}if(!t.Pony)throw Error("PTL cannot be used without Pony.JS core");e.prototype.loadJson=function(t){var e=new XMLHttpRequest;return e.overrideMimeType("application/json"),e.open("GET",this.templatePath,!0),e.onreadystatechange=function(){if(4==e.readyState&&"200"==e.status)try{var n=JSON.parse(e.responseText);t(n)}catch(r){this.onError(r)}},e.send(null),this},e.prototype.generateDelegate=function(t){var e=this.delegates[t];return function(){return e.apply(this.pony,arguments)}.bind(this)},e.prototype.generateHeadItem=function(t,e){if(!e.delegate)return e;var n={};for(var r in e)n[r]=e[r];return n.delegate=this.generateDelegate(e.delegate),e.head&&(n.head=this.generateDelegate(e.head,"head")),n},e.prototype.generateHead=function(t,e){var n={};for(var r in e)n[r]=this.generateHeadItem(t,e[r]);return n},e.prototype.generateEl=function(e,n){var r=null;if(e.pony){if(!t.Pony.Shedrow)throw Error("Cannot use advanced pony elements without Shedrow-Library loaded");if(!t.Pony.Shedrow[e.pony])throw Error("Unknown Pony "+e.pony);r=new t.Pony.Shedrow[e.pony](e.attributes,this.generateHead(r,e.head),n)}else{var o=e.tag||e.type||"div";e.attributes=e.attributes||{};for(var i in e.attributes){var a=e.attributes[i].reference;a&&(e.attributes[i]=this.context[a])}var s=null;e.text&&(s=e.text.reference?this.context[e.text.reference]:""+e.text),r=t.Pony.el(o,e.attributes,s,n)}if(e.signals){if(!t.Pony.Signal)throw Error("Signals cannot be used without Pony-Signals library loaded");for(var i in e.signals)this.signals[i]=e.signals[i]?r.signal(e.signals[i]):new Pony.Signal}if(e.children)for(var i in e.children){var h=this.generateEl(e.children[i],r);this[i]=h}return r},e.prototype.failed=function(t){return this.onError=t,this},e.prototype.load=function(t){return this.loadJson(function(e){try{return this.pony=this.generateEl(e,this.parent),t(this)}catch(n){this.onError(n)}}.bind(this)),this},e.prototype.render=function(t){return this.pony=this.generateEl(this.template,t||this.parent),this},t.Pony.Ptl=e})(this);